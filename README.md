# 日志清理脚本

## 快速使用

```bash
# 单个目录，保留70%最新文件
./log_cleaner.py /path/to/logs 70

# 多个目录，用冒号分隔
./log_cleaner.py /path1:/path2:/path3 70

# 预览模式（推荐先试用）
./log_cleaner.py /path1:/path2 70 --dry-run

# 自动确认（适合定时任务）
./log_cleaner.py /path1:/path2 70 --auto-confirm
```

## 支持的日志文件

- `*.log` - 通用日志文件
- `log.2025-12-24.0.log` - 按日期命名的日志
- `trace.2025-12-03.0.log` - trace日志
- `1201838490.log` - 数字ID日志
- `2025-12-27/1201838490.log` - 日期目录下的日志

## 工作原理

1. 扫描所有指定目录中的日志文件
2. 按修改时间全局排序（最新在前）
3. 根据百分比计算删除数量
4. 删除最旧的文件

## 参数说明

- **目录路径**: 单个目录或用冒号分隔的多个目录
- **保留百分比**: 1-99之间的整数
  - 70 = 保留最新70%，删除最旧30%
  - 90 = 保留最新90%，删除最旧10%

## 定时清理

```bash
# 每天凌晨2点清理，保留70%
0 2 * * * /path/to/log_cleaner.py /app/logs:/nginx/logs 70 --auto-confirm
```

## 兼容性

- Python 2.7+ 和 Python 3.x
- 自动处理编码问题
- 跨平台支持

## 安全特性

- 预览模式避免误删
- 详细显示删除文件信息
- 用户确认机制
- 错误处理和日志
